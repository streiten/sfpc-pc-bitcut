import processing.dxf.*;
boolean isRecording; 
String filename;
String data = "111111111000000000000111111110000011111110000000000011111111111111100000000000000000001100111111111011100000111111111111110000000000000111111111111111110000000000000011111111100000000001111111111100000000001111111111000000000001111111111111100000000000000001111111111000000000111111110000000001111111100000000000111111111100000000000000000000000111111111111000000000111111100000000001111111100000000000111111110000000000001111111111111111100000000000001111111100000000011111111111000000000001111111111000000000011111111111100000000000000111111110000000001111111000000000001111111110000000000001111111111000000000000000001111111111111000000000111111110000000011111110000000001111111110000000000111111111100000000000001111111111111100000000001111111110000000000111111111100000000001111111000000000001111111100000000000001111111111000000001111111110000000001111111111000000000011111110000000000111111111100000000000000111111111000000011111100000000111111110000000001111111000000000001111111111000000000000000111111111110000000001111111100000000001111111000000000011111110000000001111111111000000000000111111111110000000000011111110000000000111111111000000000000111111110000000000111111111000000000011111111111000000000011111110000000001111111100000000000111111110000000000011111111111000000000000011111111111000000011111111000000000011111111110000000000111111111000000000000011111111111111000000000000111111111000000000011111111100000000000111111110000000000111111111000000000000011111111111100000000000111111111000000000011111111100000000000111111111000000000011111111100000000000111111111000000000001111111100000000000111111111100000000000001111111111000000000000011111111100000000001111111000000000111111110000000001111111111100000000011111111100000000000111111111111000000000000111111111000000000011111111000000000011111111000000000111111111000000000000011111111111000000000001111111110000000000111111111100000000000001111111100000000001111111111000000000011111111000000000111111111000000000001111111111000000000000001111111111000000000001111111111100000000000111111110000000001111111000000000011111111100000000001111111111000000000000000011111111111000000000011111111000000000011111111111000000000000111111111100000000000111111111110000000000011111111100000000001111111110000000000000111111111100000000000111111111000000000011111111000000000001111111100000000011111111100000000001111111110000000000111111111111000000000001111111110000000000111111100000000111111111000000000111111111110000000000111111111100000000000001111111110000000001111111100000000111111111000000000001111111110000000000111111110000000000111111111000000000011111111100000000001111111111100000000000011111111110000000000001111111111000000000011111111000000000111111111000000000001111111111100000000000000111111111111000000000000011111111111000000000111111100000000011111111100000000001111111111000000000000001111111110000000000000111111111100000000001111111100000000000111111111000000000001111111100000000000111111111100000000000111111111000000000011111111100000000000000111111111111110000000000000011111111111000000000001111111000000001111111000000000011111111000000000000111111111111000000000000011111111111000000000001111111000000000111111110000000000111111111000000000001111111111000000000011111111111000000000001111111100000000011111111000000000000111111111110000000000001111111110000000000001111111000000000000111111000000000011111111000000000000000111111111111110000000000000000111111111111000000000011111110000000001111111111000000000001111111111100000000000001111111111111100000000000001111111110000000000111111110000000000111111111110000000000000001111111111111110000000000000111111111111100000000011111111000000000001111111111110000000000000011111111111000000000000111111111000000000011111111000000000111111111110000000000000001111111111111000000000000001111111111110000000000111111100000000111111110000000000001111111111100000000000000111111111111100000000000000111111110000000001111111000000000111111111000000000011111111100000000000011111111111110000000000111111110000000001111111100000000001111111111000000000000011111111100000000000111111111100000000011111111000000001111111000000001111111111000000000000000011111111111111100000000000000111111111000000001111110000000011111110000000000011111111111000000000000000111111111111111100000000000001111111100000000111111110000000000011111111110000000000000111111111100000000000000011111111110000000000001111111100000000000111111111111000000000000000011111111111111000000000000001111111110000000001111111100000000011111111110000000000000001111111111110000000000000000011111111111111000000000111111100000000111111100000000000001111111111111100000000000001111111111111110000000000000111111111000000001111111100000000000111111111110000000000000111111111111110000000000000011111111000000001111111100000000001111111111000000000000111111111111000000000000000111111111110000000011111110000000111111100000000001111111111000000000000001111111111110000000000000111111111110000000111111100000001111111000000000011111111111000000000000000111111111111100000000000000011111111110000000001111111000000000011111111100000000000000111111111111000000000000000111111111100000000001111110000000011111111100000000000000001111111111111100000000000000001111111111111000000000011111110000000011111110000000000001111111111110000000000000000001111111111111111110000000000000111111110000000011111110000000001111111111100000000000000111111111111110000000000000000000111111110000000000111111110000000000011111111111110000000000000000000111111111000000000000011111111000000001111111000000000011111111111100000000000000011111111111111111100000000000000011111111100000000111111100000000111111111000000000001111111111111100000000000000000000111111111110000000001111111000000011111110000000011111111110000000000000111111111111000000000000000111111111100000000011111111000000000111111111000000000000111111111111100000000000000000111111111111100000000000111111100000000001111111111000000000000111111111111100000000000000000000001111111111110000000000011111110000000011111110000000000011111111111111110000000000000000000000000001111111111110000000001111111100000000011111111000000000000011111111111111000000000000000000000001111111111111100000000001111111110000000000111111111111000000000000000011111111111111111000000000000011111111100000000001111111000000000000111111111111111000000000000000000000111111111111110000000000111111110000000011111110000000000001111111111111100000000000000000011111111111111111111000000000000111111111100000000001111111000000000111111111000000000000011111111111111111110000000000000011111111110000000001111111100000000111111111100000000000000011111111111111110000000000000111111110000000001111111100000000011111111100000000000000000111111111111111111111111100000000000000001111111100000000011111100000000011111111110000000000001111111111111111111000000000000000000000011111111100000000001111111110000000000111111111110000000000000000000111111111111111000000000001111111110000000000011111111110000000000011111111111100000000000000000000011111111111111100000000001111111111000000000111111111000000000000111111111110000000000000000000001111111111111111110000000000001111111100000000111111100000000001111111111110000000000000000000011111111111111100000000000111111100000000001111111100000000000111111111100000000000000000011111111111111111000000000001111111110000000000011111111110000000000011111111111100000000000000000111111111111100000000001111111110000000001111111100000000001111111111110000000000000000000000111111111111111110000000000011111111000000000011111110000000000011111111111110000000000000000000000001111111111111111100000000000001111111111100000000001111111111000000000000001111111111111111000000000000000000001111111110000000000001111111111000000000000011111111111111111000000000000000000000011111111110000000001111111100000000000011111111110000000000000000111111111111111111111111000000000000000001111111111100000000000011111111100000000000111111111110000000000000000011111111111111111111110000000000000011111111100000000000111111111000000000001111111111111111100000000000000000000111111111000000000001111111100000000000000111111111110000000000000000011111111111111111111000000000001111111110000000000011111111110000000000011111111110000000000000000111111111111111111100000000000001111111111000000000011111111000000000111111110000000000000000000011111111111111111110000000000011111111110000000000000111111111100000000000001111111111111110000000000000000000111111111111110000000000001111111111100000000000001111111111111100000000000000000000111111111111111000000000000111111111100000000000111111111000000000000111111111110000000000000000000000000011111111111000000000000111111111000000000001111111111000000000000011111111111111111111111000000000000000001111111111111000000000000000011111111111000000000000111111111110000000000000001111111111111000000000001111111111000000000000111111111110000000000000001111111111111111000000000000000011111111100000000001111111100000000000011111111000000000011111111111100000000000000000011111111111110000000000011111111110000000000011111111100000000111111111100000000000011111111111100000000000111111111100000000000001000100000101100101010011100100110001101101100010000110100110101000101011001010110100110101010101011101010101010001010101000001010001010111001101011101010101010101101001011000011000100000101010101010111010001010101010101011110010101010101000111010001010101010101011110010101000101001011011000111000101100101010101010101010111100101010001010001110100011101011001010110100100101001100010010010101010101011001010101010101010101110001010101010100011101000111010111010101111001011000010100101101100011100010110010101010001010011000100100100011010010110010101010101010001011100010110000101001001001010101010101100101010101010100010101000001010111010101110100011101011001011010101000101000101110001010100010000100100100011100010110010101010101010101011100010101010101001111010001110101100101101010010010100010101000101010101010010110110101010101011101000101010101010101111001011100010100100100101011100010110010101010001010001010100010101010101001011011000111000101100101010101010101010111000101010101010001110100010101010100010111000101010101010001110100010101010101010111100101100001100010000010101010101011101000101010111010101101001011000010100101101000011010110110110101000001010001010100010101010101000111010000110000101100101010101010100010101000101010101010001110100001101011101010111100101010001010010010110001110001011001010101010101010101111001011000010000100100101010101010110010101010101010101011010010010100110001001001000111000101100101010101010100010111000101100001010010010010101010101011101000111010101010101101001011000010100100100101011100010110010101010101010001011110010110000110101000001010101010101110101010101010100010111000101010101010001110100010101011101010010101000101000101110011111000000000000000011111111101001001001000001000100010101000101010011010101010101011101010100010101010101011010010100110100100111100010010010100010101000101010101010100110101101101001011011010100100101001010010110110001101001011011010100100100001000010000010101010100001101100011100010110010101010001010001010100000101010101010110010101010001010001010100010101010101000111010101010101010101011010010010100010101000101010101010101100101010101010101010110100101101001101010010010101110001011001010100100101001100010010010101110001011001000111010110110010101010101010101011110010101010101000111010001010101010101011010010110000110001000001010101010000110100001101001011001010101010101000101110001010101010100011101000101010101010101101001001010001010100000101010101010110010101010101010001010100010101010101010110010101010101010101011010010010100010101001001010111000101101101010010010100100001001001010111000101100100010101011011011010100100101001100010110110001101001011011010100100101001100010010010001110001011001010101010110010101101001001010001000100100101011100010110110101001001010011000100100101010101010111010000110101101101101010010010100110001001001010111000101100101010100010100010101000101010001010010010010101110001011011010100101100001010010110110001101001001011010101000101000101010001010100011000100000101011100010110010101010001010001000100100100011010110010101101001001010001010100010101000100001000001010101010001110100010101010100010111000101010101010001110100001101001011001010101010110010101101001001000011000100100101010101010111010101010101010001011110010110100010101000101010101010010110100011101010100010111000101010101010101100101010101010100010111100101101000101110001010100010100011101000111010001111111111111111111111000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111000000000011111111100000000000011111111111000000000000000000011111111111111111111000000000000001111111110000000000111111111110000000000000001111111111111100000000000000001111111111100000000001111111100000000001111111110000000000000000011111111111111100000000000000000001111111111110000000000111111110000000000111111111111100000000000000000111111111111111111100000000000000000000111111111100000000000111111111100000000000000111111111111000000000000000000000000001111111111110000000000001111111111000000000000000000111111111111111111111000000000000000000011111111111000000000001111111110000000000000011111111111111111111100000000000000000000000000000001111111111111100000000011111111100000000000111111111111000000000000000000010111111111111111111111111000000000000011111111000000000111111111110000000000000000111111111111110000000000000000000011111111110000000000111111111000000000000111111111111110000000000000000000011111111111111110000000000000111111100000000001111111110000000000000111111111111110000000000000000000001111111111111111100000000000111111100000000011111111110000000000000000000111111111111111111111111000000000000000000011111111110000000000001111111111000000000000000011111111111111111110000000000000000000000000001111111111000000000001111111111100000000000000011111111111111111100000000000000000000000000001111111110000000000111111110000000000111111111111111100000000000000000000000000000111111111111110000000000111111111000000000001111111111111000000000000000000000000000000000011111111111111111111000000000001111111111100000000000001111111111110000000000000000001111111111111111100000000000001111111100000000001111111111111000000000000000111111111111111110000000000000000000001111111111000000000111111100000000000011111111110000000000000000011111111111111111111111100000001000110110110001110101001101010011000010110010100010101000100010010010010100011101011010101110111001101010010010010100010111000101010001000010100110101101011001010111100101000001010101110101101101001011101010101010101110101011001011100010101101101010000000000000000111111111111111010101100100000000010010001010100010101001100100011110010110010001010001010001010101101010101011101110101010001001010010000100010101000101010011011010110100100101011010000100000101010111010111010101000111011010000010100010101000101010001010100110101001000111111111111110000001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
// Short test sequence
// String data = "1100111111111111111110000011111111111100000111111111111000001111111111110000011111111111100000111111111111111111111111000001111111111110000000000000000011111111100000000000011111111100000000000011111111100000000000011111111100000000000011111111100000000000011111111";
int stream_length = data.length();

int bit_dot_size = 5;
int bit_dot_distance = 8;
float bits_per_line = ceil(sqrt(stream_length));
float canvas_padding = bit_dot_distance * 8 ; 

void setup() {
  size(1200, 1200, P3D);
  isRecording = false;

  noFill();
  stroke(0);
  background(255);  

  println("Bits per line:" + bits_per_line);
  println("Stream length:" + stream_length);
}

void draw() {
  
  int stream_bit_pointer = 0; 

  // the canvas cut
  float canvas_size = bit_dot_distance * bits_per_line;

  if (isRecording) {
    filename = "export/export.dxf";
    beginRaw(DXF, filename);
  }
  
  rect(0,0,canvas_size+2*canvas_padding,canvas_size+2*canvas_padding);

  pushMatrix();
  translate( canvas_padding, canvas_padding);
  
  for (int i = 0; i < stream_length/bits_per_line; i++) {
    for (int j = 0; j < bits_per_line && stream_bit_pointer < stream_length; j++) {
      int x = (j*bit_dot_distance)+bit_dot_size;
      int y = (i*bit_dot_distance)+bit_dot_size;

      char c = data.charAt(stream_bit_pointer);
      if ( c == '1') {
        ellipse(x, y, bit_dot_size, bit_dot_size);
      }

      if ( (x > width) || (y > height)) println("Dots outer canvas");
      stream_bit_pointer++;
    }
  }
  popMatrix();

  if (isRecording) {
    endRaw();
    println("File saved!");
    isRecording = false;
  }
}

void keyPressed() {
  if (key == 's' ||Â key == 'S') {
    isRecording = true;
  }
}